<mat-card appearance="outlined">
  <mat-card-header>
    <div class="column-view">
      <mat-card-subtitle>{{ ticket.type }}</mat-card-subtitle>
      @if (calledByUser) {
      <p>
        <span class="semibold-text">You</span> called this ticket at
        {{ ticket.called_at | date: 'shortTime' }}
      </p>
      } @else {
      <p>
        Called by <span class="semibold-text">{{ ticket.caller!.first_name }} {{ ticket.caller!.last_name }}</span> at
        {{ ticket.called_at | date: 'shortTime' }}
      </p>
      }
    </div>
    <button
      class="view-button"
      mat-stroked-button
      color="secondary"
      (click)="toggleExpanded()">
      {{ expanded() ? 'Hide Details' : 'Show Details' }}
    </button>
  </mat-card-header>
  @if(expanded()) {
  <mat-card-content>
    <mat-divider class="spacing-divider" />
    <div class="row1">
      <p><span class="semibold-text">Helping:</span></p>
      <user-chip-list [users]="ticket.creators" [clickable]="false" />
    </div>
    <mat-divider class="spacing-divider-bottom" />
    <div class="row2">
      <div class="column">
        <!-- <p><span class="semibold-text">Description:</span></p> -->
        <p markdown>{{ ticket.concept_help_description }}</p>
        <p markdown>{{ ticket.assignment_section_description }}</p>
        <p markdown>{{ ticket.code_to_english_description }}</p>
        <p markdown>{{ ticket.concepts_needed_description }}</p>
        <p markdown>{{ ticket.tactics_tried }}</p>
      </div>
      <div class="ta-column">
        <form [formGroup]="taResponseForm" (ngSubmit)="closeButtonEvent()">
          <mat-pane>
            
            <mat-card-header class="pane-header">Meeting Summary:</mat-card-header>
            <mat-form-field appearance="outline">
              <mat-label>
                Enter Here...
              </mat-label>
              <textarea
                
                matInput
                required
                formControlName="meetingSummary"
                placeholder="Ex: We worked on a bug in the thrid part of assignment 2"></textarea>
            </mat-form-field>
            
            <mat-card-header class="pane-header">Solutions and Tools Used:</mat-card-header>
            <mat-form-field appearance="outline">
              <mat-label>
                Enter Here...
              </mat-label>
              <textarea
                matInput
                required
                formControlName="toolsUsed"
                placeholder="Ex: We realized it was a docker issue by going back through this: Link documentation"></textarea>
            </mat-form-field>

            <mat-card-header class="pane-header">Concepts for review (Optional):</mat-card-header>
            <mat-form-field appearance="outline">
              <mat-label>
                Enter Here...
              </mat-label>
              <textarea
                matInput
                formControlName="conceptsForReview"
                placeholder="Ex: Docker debugging"></textarea>
            </mat-form-field>

          </mat-pane>
        </form>
      </div>
    </div>

  </mat-card-content>
  <div class="button-row">
    <mat-card-actions>
      <button
        mat-flat-button
        class="primary-button"
        (click)="similarTicketButtonEvent()">
        See Similar Tickets
      </button>
    </mat-card-actions>
    <mat-card-actions>
      <button
        mat-flat-button
        class="tertiary-button"
        [disabled]="taResponseForm.invalid "
        (click)="closeButtonEvent()">
        Close Ticket
      </button>
    </mat-card-actions>
  </div>
  }
</mat-card>
